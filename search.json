[{"path":"index.html","id":"preface","chapter":"Preface","heading":"Preface","text":"hello world","code":""},{"path":"visualizing-seurat-objects.html","id":"visualizing-seurat-objects","chapter":"1 Visualizing Seurat objects","heading":"1 Visualizing Seurat objects","text":"","code":"\nlibrary(Seurat)\ndir = \"data/filtered_gene_bc_matrices/hg19\"\n\npbmc.data <- Read10X(data.dir = dir)\npbmc <- CreateSeuratObject(counts = pbmc.data, project = \"pbmc3k\", \n                          min.cells=3, min.features=200)\npbmc## An object of class Seurat \n## 13714 features across 2700 samples within 1 assay \n## Active assay: RNA (13714 features, 0 variable features)\npbmc[[\"percent.mt\"]] <- PercentageFeatureSet(pbmc, pattern = \"^MT-\")\npbmc <- subset(pbmc,\n  subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5\n)\npbmc <- NormalizeData(pbmc, normalization.method = \"LogNormalize\",\n                      scale.factor = 10000)\npbmc <- ScaleData(pbmc)\npbmc <- FindVariableFeatures(pbmc, selection.method = \"vst\",\n                             nfeatures = 2000)\npbmc <- RunPCA(pbmc, features = VariableFeatures(object = pbmc))\npbmc <- RunUMAP(pbmc, dims = 1:10)\npbmc <- FindNeighbors(pbmc, dims = 1:10)\npbmc <- FindClusters(pbmc, resolution = 0.5)## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n## \n## Number of nodes: 2638\n## Number of edges: 95927\n## \n## Running Louvain algorithm...\n## Maximum modularity in 10 random starts: 0.8728\n## Number of communities: 9\n## Elapsed time: 0 seconds\n## Assigning cell type identity to clusters\ncluster.ids <- c(\"Naive CD4 T\", \"CD14+ Mono\", \"Memory CD4 T\", \n            \"B\", \"CD8 T\", \"FCGR3A+ Mono\", \"NK\", \"DC\", \"Platelet\")\nnames(cluster.ids) <- levels(pbmc)\npbmc <- RenameIdents(pbmc, cluster.ids)"},{"path":"visualizing-seurat-objects.html","id":"dimensional-reduction-plot","chapter":"1 Visualizing Seurat objects","heading":"1.1 Dimensional reduction plot","text":"","code":"\n# DimPlot(pbmc, reduction = \"umap\",\n#        label = TRUE, pt.size = 0.5) \n\nlibrary(ggplot2)\nlibrary(ggsc)\n\nsc_dim(pbmc) + sc_dim_geom_label()\nsc_dim(pbmc) + \n    sc_dim_geom_label(geom = shadowtext::geom_shadowtext, \n            color='black', bg.color='white')"},{"path":"visualizing-seurat-objects.html","id":"visualize-features-on-a-dimensional-reduction-plot","chapter":"1 Visualizing Seurat objects","heading":"1.2 Visualize ‘features’ on a dimensional reduction plot","text":"real ‘features’ dimensional plot","code":"\nfeatures = c(\"MS4A1\", \"GNLY\", \"CD3E\", \n            \"CD14\", \"FCER1A\", \"FCGR3A\", \n            \"LYZ\", \"PPBP\", \"CD8A\")\n\n# FeaturePlot(pbmc,'CD4')\nsc_feature(pbmc, 'CD4')\nsc_feature(pbmc, features)\nsc_dim(pbmc) + \n   sc_dim_geom_feature(pbmc, 'CD4', color='black')\nsc_dim(pbmc, alpha=.3) + \n    ggnewscale::new_scale_color() + \n    sc_dim_geom_feature(pbmc, features, mapping=aes(color=features)) +\n    scale_color_viridis_d()\nsc_dim(pbmc) +\n    sc_dim_geom_feature(pbmc, 'CD4', color='black')\nsc_dim(pbmc, alpha=.3) +\n    ggnewscale::new_scale_color() +\n    sc_dim_geom_feature(pbmc, features, mapping=aes(color=features)) +\n    scale_color_viridis_d()"},{"path":"visualizing-seurat-objects.html","id":"visualize-ellipse-on-a-dimensional-reduction-plot","chapter":"1 Visualizing Seurat objects","heading":"1.3 Visualize ellipse on a dimensional reduction plot","text":"","code":"\nsc_dim(pbmc) +\n  sc_dim_geom_ellipse(level=0.95)"},{"path":"visualizing-seurat-objects.html","id":"visualize-selected-clusters","chapter":"1 Visualizing Seurat objects","heading":"1.4 Visualize selected clusters","text":"","code":"\nselected <- c(\"Naive CD4 T\", \"NK\")\nsc_dim(pbmc) + \n  sc_dim_sub(subset=selected)\nsc_dim(pbmc, color='grey') + \n  sc_dim_geom_sub(subset=selected) + \n    sc_dim_geom_label(geom = shadowtext::geom_shadowtext, \n          mapping = aes(subset = ident %in% selected),\n            color='black', bg.color='white')"},{"path":"visualizing-seurat-objects.html","id":"violin-plot-of-gene-expression","chapter":"1 Visualizing Seurat objects","heading":"1.5 Violin plot of gene expression","text":"","code":"\n# VlnPlot(pbmc,'CD4')\n\nsc_violin(pbmc, 'CD4')\n## allows applying an user-defined function to transform/filter the data\nsc_violin(pbmc, 'CD4', .fun=function(d) dplyr::filter(d, value > 0)) +\n  ggforce::geom_sina(size=.1)\n#VlnPlot(pbmc, features)\nsc_violin(pbmc, features) + \n  theme(axis.text.x = element_text(angle=45, hjust=1))"},{"path":"visualizing-seurat-objects.html","id":"spatial-features","chapter":"1 Visualizing Seurat objects","heading":"1.6 Spatial features","text":"","code":"\nlibrary(SeuratData)\n# InstallData(\"stxBrain\")\nbrain <- LoadData(\"stxBrain\", type = \"anterior1\")\n# Normalization \nbrain <- SCTransform(brain, assay = \"Spatial\", verbose = FALSE)\n\n## SpatialFeaturePlot(brain, features = c(\"Hpca\", \"Ttr\"))\\\nsc_spatial(brain, features = c(\"Hpca\", \"Ttr\"), image.mirror.axis = 'v')"}]
